<!doctype html>
<html lang="ar" dir="rtl">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ø§Ø³ØªØ¨ÙŠØ§Ù† ÙØ­Øµ Ø³Ø±Ø·Ø§Ù† Ø§Ù„Ø±Ø¦Ø© â€” PLCOm2012</title>
<style>
    /* Ø®Ø· Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø¹ Ø¨Ø¯Ø§Ø¦Ù„ Ù†Ø¸Ø§Ù…ÙŠØ© */
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap');

    :root {
        color-scheme: light dark;
        /* Ù„ÙˆØ­Ø© Ø£Ù„ÙˆØ§Ù† Ù…ÙˆØ¶ÙˆØ¹ ØµØ­Ø© Ø§Ù„Ø±Ø¦Ø© */
        --primary: #0ea5a2;
        --primary-b: #0ea5a2;
        --primary-2: #2dd4bf;
        --bg: linear-gradient(135deg, #f0fdfa, #ecfeff);
        --card: #ffffff;
        --line: #e6e6e6;
        --fg: #101828;
        --muted: #64748b;

        /* Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        --ok-b: #16a34a;
        --ok: #16a34a20;
        --warn-b: #f59e0b;
        --warn: #f59e0b20;
        --danger-b: #ef4444;
        --danger: #ef444420;
    }

    * {
        box-sizing: border-box
    }

    html { -webkit-text-size-adjust: 100%; }

    body {
        font-family: 'Tajawal', system-ui, -apple-system, Segoe UI, sans-serif;
        font-size: 16px;
        color: var(--fg);
        margin: 0;
        background: var(--bg);
        min-height: 100vh;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    .wrap {
        max-width: 920px;
        margin: 40px auto;
        padding: 16px;
    }

    header {
        display: flex;
        align-items: center;
        gap: 14px;
        margin-bottom: 18px;
        padding: 18px;
        background: linear-gradient(135deg, var(--primary), var(--primary-2));
        color: #fff;
        border-radius: 16px;
        box-shadow: 0 6px 22px rgba(14, 165, 162, 0.25);
    }

    .logo {
        width: 54px;
        height: 54px;
        border-radius: 50%;
        background: radial-gradient(circle at 30% 30%, #ffffff, #ccfbf1 35%, rgba(255, 255, 255, 0.15) 36%),
            linear-gradient(135deg, #0ea5a2, #2dd4bf);
        position: relative;
        flex: 0 0 auto;
        box-shadow: inset 0 0 0 2px rgba(255, 255, 255, 0.35);
    }

    .logo::before {
        content: 'ğŸ«';
        position: absolute;
        inset: 0;
        display: grid;
        place-items: center;
        font-size: 26px;
    }

    h1 {
        font-size: 22px;
        margin: 0;
        line-height: 1.2;
    }

    .sub {
        color: #e6fffb;
        margin-top: 4px;
        font-size: 14px
    }

    fieldset {
        margin: 16px 0;
        padding: 14px;
        background: var(--card);
        border: 1px solid var(--line);
        border-radius: 14px;
        box-shadow: 0 4px 16px rgba(2, 132, 199, 0.06);
    }

    legend {
        padding: 0 6px;
        font-weight: 700;
        color: var(--primary-b)
    }

    label {
        display: block;
        margin: 8px 0
    }

    select,
    input {
        padding: 12px 12px;
        border: 1px solid #cfd3d7;
        border-radius: 10px;
        width: 100%;
        background: #fff;
        transition: border-color .2s ease, box-shadow .2s ease, background .2s ease, color .2s ease;
        accent-color: var(--primary-b);
        font: inherit;
        line-height: 1.2;
        display: block;
    }

    /* ØªØ­Ø³ÙŠÙ† Ù…Ø¸Ù‡Ø± Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØªØ±ØªÙŠØ¨ Ø§Ù„Ù†Øµ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
    label {
        display: block;
        margin: 10px 0;
        font-weight: 600;
    }

    label>input,
    label>select {
        margin-top: 6px;
        font-weight: 400;
    }

    /* Ø¥Ø®ÙØ§Ø¡ ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù†ØµØ± Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø­Ù‚Ù„ Ù…Ø®ÙÙŠØ§Ù‹ */
    label:has(input[hidden]),
    label[hidden] {
        display: none !important;
    }

    input:focus,
    select:focus {
        outline: none;
        border-color: var(--primary-b);
        box-shadow: 0 0 0 3px rgba(14, 165, 162, .15)
    }

    input[readonly] {
        background: #f8fafc;
        color: #6b7280;
        cursor: default;
    }

    /* Ø¥Ø¨Ø±Ø§Ø² Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ØµØ­ÙŠØ­Ø©/Ø§Ù„Ø®Ø§Ø·Ø¦Ø© Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± Ø§Ù„Ù†Øµ */
    input:required:user-invalid,
    select:required:user-invalid {
        border-color: var(--danger-b);
        box-shadow: 0 0 0 3px rgba(239, 68, 68, .12);
    }

    input:required:user-valid,
    select:required:user-valid {
        border-color: var(--ok-b);
        box-shadow: 0 0 0 3px rgba(22, 163, 74, .12);
    }

    /* Ø¥Ø®ÙØ§Ø¡ Ø£Ø³Ù‡Ù… Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø£Ù†Ø¸Ù */
    input[type="number"] {
        -moz-appearance: textfield;
    }

    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø³Ù„ÙƒØª */
    select {
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: left 12px center;
        /* RTL: Ø§Ù„Ø³Ù‡Ù… ÙŠØ³Ø§Ø± */
        background-size: 18px 18px;
        padding-inline-start: 40px;
        padding-inline-end: 12px;
        /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ø³Ù‡Ù… */
    }

    select::-ms-expand {
        display: none;
    }

    input::placeholder {
        color: #9aa4b2
    }

    .row {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        align-items: flex-start;
    }

    .row>label {
        flex: 1 1 220px;
        min-width: 0;
    }

    .ckg {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 10px
    }

    .ckg label {
        display: flex;
        gap: 10px;
        align-items: flex-start; /* Ù„Ø«Ø¨Ø§Øª Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù†Øµ ÙÙŠ iOS ÙˆØ§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø© */
        line-height: 1.4;
        background: #fff;
        border: 1px solid var(--line);
        border-radius: 10px;
        padding: 10px;
        transition: transform .12s ease, box-shadow .12s ease, border-color .2s ease;
    }

    .ckg label:hover {
        transform: translateY(-1px);
        box-shadow: 0 6px 14px rgba(2, 132, 199, .08)
    }

    .ckg input[type=checkbox] {
        accent-color: var(--primary-b);
        flex: 0 0 auto;
        width: 18px;
        height: 18px;
        margin-top: 2px; /* ÙŠÙˆØ§Ø²Ù† Ø³Ø·Ø± Ø§Ù„Ù†Øµ Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ iOS */
    }

    /* Ø¥Ø¨Ø±Ø§Ø² Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª */
    .ckg label:has(input:checked) {
        border-color: var(--primary-b);
        box-shadow: 0 6px 14px rgba(14, 165, 162, .15);
        background: linear-gradient(180deg, #ffffff, #f7fffe);
    }

    button {
        padding: 12px 20px;
        border: 0;
        border-radius: 12px;
        cursor: pointer;
        background: linear-gradient(135deg, var(--primary), var(--primary-2));
        color: white;
        font-weight: 700;
        letter-spacing: .2px;
        box-shadow: 0 6px 16px rgba(14, 165, 162, .25);
        transition: transform .1s ease, box-shadow .2s ease, filter .2s ease;
    }

    button:hover {
        filter: brightness(1.03);
        box-shadow: 0 8px 20px rgba(14, 165, 162, .3)
    }

    button:active {
        transform: translateY(1px)
    }

    @media (max-width: 520px) {
        button[type=submit] {
            width: 100%;
        }
        select { background-image: none; padding-inline-start: 12px; }
    }

    /* Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„Ù…Ø³ÙŠØ© (iOS/Android): Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø³Ù‡Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„ØªÙØ§Ø¯ÙŠ Ø§Ù„Ø§Ø²Ø¯ÙˆØ§Ø¬ÙŠØ© */
    @media (hover: none) and (pointer: coarse) {
        select { background-image: none !important; padding-inline-start: 12px; }
    }

    .result {
        margin-top: 16px;
        padding: 16px 18px;
        border-radius: 14px;
        border: 1px solid var(--line);
        background: #fff;
        box-shadow: 0 6px 18px rgba(2, 132, 199, .06);
        position: relative;
    }

    .result::before {
        content: '';
        position: absolute;
        inset-inline-start: 0;
        inset-block: 0;
        width: 6px;
        border-radius: 14px 0 0 14px;
        background: transparent;
    }

    .ok {
        background: var(--ok);
        border-color: var(--ok-b)
    }

    .ok::before {
        background: var(--ok-b)
    }

    .warn {
        background: var(--warn);
        border-color: var(--warn-b)
    }

    .warn::before {
        background: var(--warn-b)
    }

    .danger {
        background: var(--danger);
        border-color: var(--danger-b)
    }

    .danger::before {
        background: var(--danger-b)
    }

    .muted {
        color: var(--muted)
    }

    .foot {
        font-size: 13px;
        color: #555;
        margin-top: 12px
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --bg: linear-gradient(135deg, #052e2b, #0b3b3b);
            --card: #0b1f1e;
            --line: #12312f;
            --fg: #e6f8f6;
            --muted: #9fb6b3;
        }

        header {
            box-shadow: 0 6px 22px rgba(0, 0, 0, .35)
        }

        select,
        input {
            background: #0f2422;
            color: var(--fg);
            border-color: #1b3c39
        }

        select {
            /* ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ† Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆØ§ØªÙ ØªØ¸Ù‡Ø± Ø£Ø³Ù‡Ù… Ù…ÙƒØ±Ø±Ø© Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ØŒ Ù†Ø¹ØªÙ…Ø¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ */
            background-image: none !important;
            padding-inline-start: 12px;
        }

        .ckg label {
            background: #0f2422;
            border-color: #1b3c39
        }

        .result {
            background: #0f2422;
            border-color: #1b3c39
        }

        input[readonly] {
            background: #0e2321;
            color: #97acab;
        }

        button {
            box-shadow: 0 6px 16px rgba(0, 0, 0, .35)
        }

        .muted { color: #a7bfbc; }
    }
</style>

<div class="wrap">
    <header>
        <div class="logo" aria-hidden="true"></div>
        <div>
            <h1>Ø§Ø³ØªØ¨ÙŠØ§Ù† ÙØ­Øµ Ø³Ø±Ø·Ø§Ù† Ø§Ù„Ø±Ø¦Ø© (PLCOm2012)</h1>
            <div class="sub">Ù„Ù„Ù…ÙØ¯Ø®Ù†ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ† Ø£Ùˆ Ø§Ù„Ø³Ø§Ø¨Ù‚ÙŠÙ† ÙÙ‚Ø·. Ø°ÙˆÙˆ Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ø¥Ù†Ø°Ø§Ø±ÙŠØ© = Ù…Ø³Ø§Ø± ØªØ´Ø®ÙŠØµ.</div>
        </div>
    </header>

    <form id="f">
        <fieldset>
            <legend>Ø£Ø¹Ø±Ø§Ø¶ Ø¥Ù†Ø°Ø§Ø±ÙŠØ© (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)</legend>
            <div class="ckg">
                <label><input type="checkbox" name="alarm" value="Ø³Ø¹Ø§Ù„ Ù…Ø³ØªÙ…Ø± &gt;3 Ø£Ø³Ø§Ø¨ÙŠØ¹"> Ø³Ø¹Ø§Ù„ Ù…Ø³ØªÙ…Ø± &gt;3
                    Ø£Ø³Ø§Ø¨ÙŠØ¹</label>
                <label><input type="checkbox" name="alarm" value="Ù†ÙØ« Ø¯Ù…"> Ù†ÙØ« Ø¯Ù…</label>
                <label><input type="checkbox" name="alarm" value="Ù†Ù‚Øµ ÙˆØ²Ù† ØºÙŠØ± Ù…ÙØ³Ø±"> Ù†Ù‚Øµ ÙˆØ²Ù† ØºÙŠØ± Ù…ÙØ³Ø±</label>
                <label><input type="checkbox" name="alarm" value="Ø£Ù„Ù…/Ø§Ù†Ø²Ø¹Ø§Ø¬ ØµØ¯Ø±ÙŠ Ù…Ø³ØªÙ…Ø±"> Ø£Ù„Ù…/Ø§Ù†Ø²Ø¹Ø§Ø¬ ØµØ¯Ø±ÙŠ Ù…Ø³ØªÙ…Ø±</label>
                <label><input type="checkbox" name="alarm" value="Ø§Ù„ØªÙ‡Ø§Ø¨Ø§Øª ØµØ¯Ø± Ù…ØªÙƒØ±Ø±Ø©"> Ø§Ù„ØªÙ‡Ø§Ø¨Ø§Øª ØµØ¯Ø± Ù…ØªÙƒØ±Ø±Ø©</label>
                <label><input type="checkbox" name="alarm" value="Ø¨Ø­Ù‘Ø©/ØªØºÙŠÙ‘Ø± Ø¨Ø§Ù„ØµÙˆØª"> Ø¨Ø­Ù‘Ø©/ØªØºÙŠÙ‘Ø± Ø¨Ø§Ù„ØµÙˆØª</label>
                <label><input type="checkbox" name="alarm" value="Ø¶ÙŠÙ‚ Ù†ÙØ³ Ù…ØªÙØ§Ù‚Ù…"> Ø¶ÙŠÙ‚ Ù†ÙØ³ Ù…ØªÙØ§Ù‚Ù…</label>
                <label><input type="checkbox" name="alarm" value="ÙÙ‚Ø¯Ø§Ù† Ø´Ù‡ÙŠØ© Ù…Ù„Ø­ÙˆØ¸"> ÙÙ‚Ø¯Ø§Ù† Ø´Ù‡ÙŠØ© Ù…Ù„Ø­ÙˆØ¸</label>
            </div>
            <div class="muted" style="margin-top:6px">ÙˆØ¬ÙˆØ¯ Ø£ÙŠ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ ÙŠØ³ØªÙˆØ¬Ø¨ Ù…Ø³Ø§Ø± ØªØ´Ø®ÙŠØµ ÙˆÙ„ÙŠØ³ ØªØ­Ø±Ù‘ÙŠ/Screening.
            </div>
        </fieldset>

        <fieldset>
            <legend>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</legend>
            <div class="row">
                <label>Ø§Ù„Ø¹Ù…Ø± (Ø³Ù†ÙˆØ§Øª)
                    <input type="number" name="age" min="18" max="90" required inputmode="numeric" enterkeyhint="next">
                </label>
                <label>Ø§Ù„ÙˆØ²Ù† (ÙƒØº)
                    <input type="number" name="weight" step="0.1" min="20" max="300" required inputmode="decimal"
                        enterkeyhint="next">
                </label>
                <label>Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)
                    <input type="number" name="height_cm" step="0.1" min="100" max="250" required inputmode="decimal"
                        enterkeyhint="next">
                </label>
                <label>BMI (ÙŠÙØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)
                    <input type="number" name="bmi" step="0.1" min="10" max="60" readonly aria-readonly="true">
                </label>
                <label>Ø§Ù„ØªØ¹Ù„ÙŠÙ… (1=Ø£Ù‚Ù„ Ù…Ù† Ø«Ø§Ù†ÙˆÙŠ â€¦ 6=Ø¯Ø±Ø§Ø³Ø§Øª Ø¹Ù„ÙŠØ§)
                    <select name="edu" required>
                        <option value="1">Ø£Ù‚Ù„ Ù…Ù† Ø«Ø§Ù†ÙˆÙŠ</option>
                        <option value="2">Ø«Ø§Ù†ÙˆÙŠ</option>
                        <option value="3">Ø¯Ø¨Ù„ÙˆÙ…/Ù…Ø¹Ù‡Ø¯</option>
                        <option value="4" selected>Ø¬Ø§Ù…Ø¹ÙŠ</option>
                        <option value="5">Ø¯Ø±Ø§Ø³Ø§Øª Ø¹Ù„ÙŠØ§</option>
                        <option value="6">Ù…Ø§Ø¬Ø³ØªÙŠØ±/Ø¯ÙƒØªÙˆØ±Ø§Ù‡</option>
                    </select>
                </label>
            </div>
            <label>ØªØ´Ø®ÙŠØµ Ø³Ø§Ø¨Ù‚: COPD/Ù†ÙØ§Ø®/Ø§Ù„ØªÙ‡Ø§Ø¨ Ø´Ø¹Ø¨ Ù…Ø²Ù…Ù†ØŸ
                <select name="copd" required>
                    <option value="0">Ù„Ø§</option>
                    <option value="1">Ù†Ø¹Ù…</option>
                </select>
            </label>
            <label>Ù‚ØµØ© Ø´Ø®ØµÙŠØ© Ù„Ø³Ø±Ø·Ø§Ù† Ø³Ø§Ø¨Ù‚ØŸ
                <select name="cancer_hist" required>
                    <option value="0">Ù„Ø§</option>
                    <option value="1">Ù†Ø¹Ù…</option>
                </select>
            </label>
            <label>Ù‚ØµØ© Ø¹Ø§Ø¦Ù„ÙŠØ© (Ø¯Ø±Ø¬Ø© Ø£ÙˆÙ„Ù‰) Ù„Ø³Ø±Ø·Ø§Ù† Ø§Ù„Ø±Ø¦Ø©ØŸ
                <select name="fam" required>
                    <option value="0">Ù„Ø§</option>
                    <option value="1">Ù†Ø¹Ù…</option>
                </select>
            </label>
            <!-- Ø§Ù„Ø¹ÙØ±Ù‚ Ù…Ø­Ø°ÙˆÙ Ù…Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆÙ…ÙØ«Ø¨Ù‘Øª Ø­Ø³Ø§Ø¨Ù‡ Ø¯Ø§Ø®Ù„ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Baseline (ØºÙŠØ± Ù…Ø­Ø¯Ø¯) -->
        </fieldset>

        <fieldset>
            <legend>Ø§Ù„ØªØ¯Ø®ÙŠÙ†</legend>
            <label>Ø§Ù„Ø­Ø§Ù„Ø©:
                <select name="smk_status" required>
                    <option value="current">Ù…Ø¯Ø®Ù‘Ù† Ø­Ø§Ù„ÙŠÙ‹Ø§</option>
                    <option value="former">Ø£Ù‚Ù„Ø¹Øª</option>
                </select>
            </label>
            <label>Ù…Ù†ØªØ¬ Ø§Ù„ØªØ¯Ø®ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… :
                <select name="smk_product" required>
                    <option value="cigarette" selected>Ø³Ø¬Ø§Ø¦Ø±</option>
                    <option value="hookah">Ù†Ø±Ø¬ÙŠÙ„Ø©</option>
                    <option value="vape">Ø§Ù„ÙÙŠØ¨ (Vape)</option>
                </select>
            </label>
            <div class="row">
                <label>Ù…ØªÙˆØ³Ø· Ø³Ø¬Ø§Ø¦Ø±/Ø§Ù„ÙŠÙˆÙ…
                    <input type="number" name="cigs_per_day" min="1" max="200" required inputmode="numeric"
                        enterkeyhint="next">
                </label>
                <label hidden>Ø±Ø£Ø³ Ø§Ø±Ù‚ÙŠÙ„Ø© Ù„ÙƒÙ„ ÙŠÙˆÙ…
                    <input type="number" name="heads_per_day" min="0" step="0.1" value="0" required inputmode="decimal"
                        enterkeyhint="next" hidden disabled>
                </label>
                <label hidden>Ø±Ø£Ø³(bode) Ù„ÙƒÙ„ ÙŠÙˆÙ…
                    <input type="number" name="pods_per_day" min="0" step="0.1" value="0" required inputmode="decimal"
                        enterkeyhint="next" hidden disabled>
                </label>
                <label>Ø³Ù†ÙˆØ§Øª Ø§Ù„ØªØ¯Ø®ÙŠÙ†
                    <input type="number" name="years_smoked" min="1" max="80" required inputmode="numeric"
                        enterkeyhint="next">
                </label>
                <label>Ø³Ù†ÙˆØ§Øª Ù…Ù†Ø° Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹ (Ø¥Ù† ÙˆÙØ¬Ø¯)
                    <input type="number" name="years_since_quit" min="0" max="80" value="0" required inputmode="numeric"
                        enterkeyhint="done" hidden disabled>
                </label>
            </div>
            <div class="muted">Pack-years (ØªÙ‚Ø±ÙŠØ¨ÙŠ): <span id="py">0.0</span></div>
        </fieldset>

        <button type="submit">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø±Ø§Ø±</button>
    </form>

    <div class="result" id="out" hidden></div>

    <div class="foot">
        Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠ: Ø¥Ø­Ø§Ù„Ø© Ù„Ù„Ù€LDCT Ø¥Ø°Ø§ ÙƒØ§Ù† Ø®Ø·Ø± <b>PLCOm2012 â‰¥ 1.51%</b> Ø®Ù„Ø§Ù„ 6 Ø³Ù†ÙˆØ§Øª. Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ.
    </div>
</div>

<script>
    /* Ù…Ø¹Ø§Ù…Ù„Ø§Øª PLCOm2012 (Ø¬Ø¯ÙˆÙ„ 2 â€” NEJM 2013)ØŒ Ù…Ø¹ ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¹ÙØ±Ù‚ Ø¹Ù„Ù‰ Baseline (Ø£Ø«Ø± ØµÙØ±ÙŠ). */
    const B = {
        age: 0.0778868,
        edu: -0.0812744,
        bmi: -0.0274194,
        copd: 0.3553063,
        cancer_hist: 0.4589971,
        fam: 0.587185,
        smk_current: 0.2597431,
        intensity: -1.822606,  // (cigs/10)^(-1) Ù…ØªÙ…Ø±ÙƒØ²Ø©
        duration: 0.0317321,
        quit: -0.0308572,
        constant: -4.532506
    };
    const CENTER = { age: 62, edu: 4, bmi: 27, duration: 27, quit: 10 };
    const INTENSITY_CENTER = 0.4021541613;
    const THRESH = 0.0151;

    function plcoProb(input) {
        if (input.cigs_per_day <= 0 || input.years_smoked <= 0) {
            throw new Error("Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù…Ø®ØµØµ Ù„Ù…Ù† Ø¯Ø®Ù‘Ù†ÙˆØ§ Ø³Ø§Ø¨Ù‚Ù‹Ø§ ÙˆØ¨Ù‚ÙŠÙ…Ø© Ø³Ø¬Ø§Ø¦Ø±/Ø§Ù„ÙŠÙˆÙ… ÙˆØ³Ù†ÙˆØ§Øª ØªØ¯Ø®ÙŠÙ† > 0.");
        }
        let L = B.constant;
        L += B.age * (input.age - CENTER.age);
        L += B.edu * (input.edu - CENTER.edu);
        L += B.bmi * (input.bmi - CENTER.bmi);
        L += B.duration * (input.years_smoked - CENTER.duration);
        L += B.quit * (input.years_since_quit - CENTER.quit);
        const transformedIntensity = Math.pow(input.cigs_per_day / 10, -1) - INTENSITY_CENTER;
        L += B.intensity * transformedIntensity;
        L += B.copd * (input.copd ? 1 : 0);
        L += B.cancer_hist * (input.cancer_hist ? 1 : 0);
        L += B.fam * (input.fam ? 1 : 0);
        L += B.smk_current * (input.smk_status === 'current' ? 1 : 0);
        // Ù„Ø§ Ù†Ø¶ÙŠÙ Ø£ÙŠ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¹ÙØ±Ù‚ â†’ Ù…Ø«Ø¨Øª Ø¹Ù„Ù‰ Baseline (ØºÙŠØ± Ù…Ø­Ø¯Ø¯)
        const p = Math.exp(L) / (1 + Math.exp(L));
        return p;
    }
    function decision(p) { return (p >= THRESH) ? "Ù…Ø¤Ù‡Ù‘Ù„: Ø§ÙØ­Øµ LDCT Ø³Ù†ÙˆÙŠÙ‹Ø§" : "ØºÙŠØ± Ù…Ø¤Ù‡Ù‘Ù„ Ø§Ù„Ø¢Ù†: Ø¯Ø¹Ù… Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹ ÙˆØ£Ø¹Ø¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø®Ù„Ø§Ù„ 12 Ø´Ù‡Ø±Ù‹Ø§"; }

    const f = document.getElementById('f');
    const pySpan = document.getElementById('py');

    // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø­Ù‚Ù„ "Ø³Ù†ÙˆØ§Øª Ù…Ù†Ø° Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹" Ø­Ø³Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¯Ø®ÙŠÙ†
    const quitInput = f.querySelector('input[name="years_since_quit"]');
    const quitLabel = quitInput ? quitInput.closest('label') : null;
    function toggleQuitField() {
        const isFormer = f.smk_status.value === 'former';
        if (quitLabel) quitLabel.hidden = !isFormer;
        if (quitInput) {
            quitInput.hidden = !isFormer;
            quitInput.disabled = !isFormer;
            quitInput.required = isFormer;
            if (!isFormer) quitInput.value = '0';
        }
    }
    if (f.smk_status) {
        f.smk_status.addEventListener('change', toggleQuitField);
        toggleQuitField();
    }
    // Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬ ÙˆØ­Ù‚Ù„ Ø§Ù„ÙƒÙ…ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†ØªØ¬
    const productSel = f.querySelector('select[name="smk_product"]');
    const cigsInput = f.cigs_per_day;
    const headsInput = f.heads_per_day;
    const podsInput = f.pods_per_day;
    function currentCigsPerDay() {
        const prod = productSel?.value || 'cigarette';
        if (prod === 'hookah') return (parseFloat(headsInput?.value) || 0) * 20;
        if (prod === 'vape') return (parseFloat(podsInput?.value) || 0) * 20;
        return parseFloat(cigsInput?.value) || 0;
    }
    function toggleProductFields() {
        const prod = productSel?.value || 'cigarette';
        const setVis = (el, show) => {
            if (!el) return;
            const lab = el.closest('label');
            if (lab) lab.hidden = !show;
            el.hidden = !show;
            el.disabled = !show;
            el.required = !!show;
        };
        setVis(cigsInput, prod === 'cigarette');
        setVis(headsInput, prod === 'hookah');
        setVis(podsInput, prod === 'vape');
    }
    function updatePY() {
        const cigs = currentCigsPerDay();
        const years = +f.years_smoked.value || 0;
        const packsPerDay = cigs / 20;
        pySpan.textContent = (packsPerDay * years).toFixed(1);
    }
    if (productSel) productSel.addEventListener('change', () => { toggleProductFields(); updatePY(); });
    if (cigsInput) cigsInput.addEventListener('input', updatePY);
    if (headsInput) headsInput.addEventListener('input', updatePY);
    if (podsInput) podsInput.addEventListener('input', updatePY);
    if (f.years_smoked) f.years_smoked.addEventListener('input', updatePY);
    toggleProductFields();
    updatePY();

    // Ø§Ø­Ø³Ø¨ Ø§Ù„Ù€ BMI ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„ÙˆØ²Ù† ÙˆØ§Ù„Ø·ÙˆÙ„ (Ø³Ù…)
    function updateBMI() {
        const w = parseFloat(f.weight?.value);
        const hcm = parseFloat(f.height_cm?.value);
        if (!isNaN(w) && w > 0 && !isNaN(hcm) && hcm > 0) {
            const hm = hcm / 100;
            const bmi = w / (hm * hm);
            if (isFinite(bmi)) {
                f.bmi.value = bmi.toFixed(1);
                return;
            }
        }
        f.bmi.value = '';
    }
    if (f.weight && f.height_cm) {
        f.weight.addEventListener('input', updateBMI);
        f.height_cm.addEventListener('input', updateBMI);
        // Ø§Ø­Ø³Ø¨Ù‡ Ù…Ø±Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ… Ù…ÙˆØ¬ÙˆØ¯Ø©
        updateBMI();
    }

    f.addEventListener('submit', e => {
        e.preventDefault();
        const fd = new FormData(f);
        const alarms = fd.getAll('alarm'); // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
        const v = Object.fromEntries(fd.entries());
        // ÙÙŠ Ø­Ø§Ù„ ÙƒØ§Ù† Ù…Ø¯Ø®Ù† Ø­Ø§Ù„ÙŠØŒ Ù‚ÙŠÙ…Ø© Ø³Ù†ÙˆØ§Øª Ù…Ù†Ø° Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹ = 0
        if (v.smk_status === 'current') {
            v.years_since_quit = '0';
        }
        // ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø³Ø§Ø¨ BMI Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙØ¹Ø¨Ø£Ù‹
        if ((!v.bmi || v.bmi === '') && f.weight && f.height_cm) {
            updateBMI();
            const current = new FormData(f);
            v.bmi = current.get('bmi');
        }
        const inp = {
            age: Number(v.age),
            bmi: Number(v.bmi),
            edu: Number(v.edu),
            copd: Number(v.copd),
            cancer_hist: Number(v.cancer_hist),
            fam: Number(v.fam),
            smk_status: v.smk_status,
            cigs_per_day: currentCigsPerDay(),
            years_smoked: Number(v.years_smoked),
            years_since_quit: Number(v.years_since_quit)
        };

        // ØªØ­Ù‚Ù‚ Ù…Ø¨ÙƒØ±: ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ BMI ØµØ§Ù„Ø­
        if (!isFinite(inp.bmi) || inp.bmi <= 0) {
            const out = document.getElementById('out');
            out.hidden = false;
            out.className = 'result danger';
            out.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙˆØ²Ù† ÙˆØ§Ù„Ø·ÙˆÙ„ Ù„Ø­Ø³Ø§Ø¨ BMI Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.';
            return;
        }

        const out = document.getElementById('out');
        out.hidden = false;

        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ù…Ø± Ø£Ù‚Ù„ Ù…Ù† 35: Ø§Ø­Ø³Ø¨ Ø¹Ø§Ø¯ÙŠ Ù„ÙƒÙ† Ø§Ù„ØªÙˆØµÙŠØ© Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹ Ø¹Ù† Ø§Ù„ØªØ¯Ø®ÙŠÙ†
        if (inp.age < 35) {
            try {
                const p = plcoProb(inp);
                out.className = 'result warn';
                out.innerHTML = `
      <b>Ø§Ù„ØªÙˆØµÙŠØ©:</b> Ù†Ù†ØµØ­ Ø¨Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹ Ø¹Ù† Ø§Ù„ØªØ¯Ø®ÙŠÙ†<br>
      <b>Ø®Ø·Ø± 6 Ø³Ù†ÙˆØ§Øª (PLCOm2012):</b> ${(p * 100).toFixed(2)}%
    `;
            } catch (err) {
                out.className = 'result danger';
                out.textContent = err.message;
            }
            return;
        }

        if (alarms.length > 0) {
            out.className = 'result danger';
            out.innerHTML = `<b>Ù…Ø³Ø§Ø± ØªØ´Ø®ÙŠØµ ÙÙˆØ±ÙŠ (Ù„ÙŠØ³ ØªØ­Ø±Ù‘ÙŠ/Screening).</b><br>
      Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©: ${alarms.map(s => `<span>â€¢ ${s}</span>`).join(' ØŒ ')}<br>
      ÙŠÙÙ†ØµÙØ­ Ø¨Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ø¨ÙŠØ¨/Ø·ÙˆØ§Ø±Ø¦ Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØªØµÙˆÙŠØ± Ù…Ù†Ø§Ø³Ø¨.`;
            return;
        }

        try {
            const p = plcoProb(inp);
            const label = decision(p);
            out.className = 'result ' + ((p >= THRESH) ? 'ok' : 'warn');
            out.innerHTML = `
      <b>Ø§Ù„Ù‚Ø±Ø§Ø±:</b> ${label}<br>
      <b>Ø®Ø·Ø± 6 Ø³Ù†ÙˆØ§Øª (PLCOm2012):</b> ${(p * 100).toFixed(2)}%
    `;
        } catch (err) {
            out.className = 'result danger';
            out.textContent = err.message;
        }
    });
    // ØªØ®ØµÙŠØµ Ø§Ù„Ù†ØµÙˆØµ Ù„ØªÙƒÙˆÙ† Ø¹Ø±Ø¨ÙŠØ© ÙˆÙ…ÙˆØ¬Ù‡Ø© Ù„Ù„Ù…Ø±Ø¶Ù‰ØŒ ÙˆØ¥Ø²Ø§Ù„Ø© Ø°ÙƒØ± Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙØ­ÙˆØµ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
    (function () {
        try {
            document.title = 'ØªÙ‚ÙŠÙŠÙ… Ø®Ø·Ø± Ø³Ø±Ø·Ø§Ù† Ø§Ù„Ø±Ø¦Ø©';
            const h1 = document.querySelector('h1');
            if (h1) h1.textContent = 'ØªÙ‚ÙŠÙŠÙ… Ø®Ø·Ø± Ø³Ø±Ø·Ø§Ù† Ø§Ù„Ø±Ø¦Ø©';
            const sub = document.querySelector('.sub');
            if (sub) sub.textContent = 'Ø­Ø§Ø³Ø¨Ø© Ù„ØªÙ‚Ø¯ÙŠØ± Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ø¥ØµØ§Ø¨Ø© Ø®Ù„Ø§Ù„ 6 Ø³Ù†ÙˆØ§Øª Ù„Ù„Ù…Ø¯Ø®Ù†ÙŠÙ† ÙˆØ§Ù„Ø­Ø§Ù„ÙŠÙŠÙ† Ø£Ùˆ Ø§Ù„Ù…Ù‚Ù„Ø¹ÙŠÙ† Ø­Ø¯ÙŠØ«Ø§Ù‹. Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¥Ø±Ø´Ø§Ø¯ÙŠØ© ÙˆÙ„Ø§ ØªØºÙ†ÙŠ Ø¹Ù† Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨.';
            const mutedFirst = document.querySelector('fieldset .muted');
            if (mutedFirst) mutedFirst.textContent = 'Ù‡Ø°Ù‡ Ù…Ø¤Ø´Ø±Ø§Øª Ø¥Ù†Ø°Ø§Ø±Ø› Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ø£ÙŠ Ù…Ù†Ù‡Ø§ ÙŠÙÙØ¶Ù‘Ù„ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø§Ø³Ø¨Ø©.';
            const foot = document.querySelector('.foot');
            if (foot) foot.innerHTML = 'Ù…Ø¹Ù„ÙˆÙ…Ø© Ù„Ù„Ù‚Ø±Ø§Ø±: Ù†Ø³ØªØ®Ø¯Ù… Ø­Ø¯ 1.51% Ø®Ù„Ø§Ù„ 6 Ø³Ù†ÙˆØ§Øª Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„Ø·Ø¨Ù‚ÙŠ Ø§Ù„Ù…Ø­ÙˆØ±ÙŠ Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ø¬Ø±Ø¹Ø©.';

            // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙˆØµÙŠØ© Ø¨Ù†Ø³Ø®Ø© Ø¨ØµÙŠØ§ØºØ© Ø¹Ø±Ø¨ÙŠØ© Ù„Ù„Ù…Ø±ÙŠØ¶
            window.decision = function (p) {
                return (p >= THRESH)
                    ? 'Ù†Ù†ØµØ­ Ø¨Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„Ø·Ø¨Ù‚ÙŠ Ø§Ù„Ù…Ø­ÙˆØ±ÙŠ Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ø¬Ø±Ø¹Ø©'
                    : 'Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„ÙØ­Øµ Ø·Ø¨Ù‚ÙŠ Ø§Ù„Ø¢Ù†Ø› Ø§Ù„Ø£Ù‡Ù… Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹ Ø¹Ù† Ø§Ù„ØªØ¯Ø®ÙŠÙ† ÙˆÙ…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø¹Ù†Ø¯ Ø¸Ù‡ÙˆØ± Ø£Ø¹Ø±Ø§Ø¶.';
            };

            // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª Ù…Ù† Ø£ÙŠ Ø°ÙƒØ± Ù„Ù€ PLCOm2012/LDCT/Screening ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨ØµÙŠØ§ØºØ© Ø¹Ø±Ø¨ÙŠØ© Ù…Ø¨Ø³Ø·Ø©
            const postProcess = () => {
                const out = document.getElementById('out');
                if (!out) return;
                out.innerHTML = out.innerHTML
                    .replace(/\(PLCOm2012\)/gi, '')
                    .replace(/PLCOm2012/gi, '')
                    .replace(/LDCT/gi, 'Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„Ø·Ø¨Ù‚ÙŠ Ø§Ù„Ù…Ø­ÙˆØ±ÙŠ Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ø¬Ø±Ø¹Ø©')
                    .replace(/Screening/gi, 'Ø§Ù„ÙØ­Øµ Ø§Ù„Ù…Ø¨ÙƒØ±')
                    .replace(/Ø®Ø·Ø± 6 Ø³Ù†ÙˆØ§Øª/gi, 'Ø®Ø·Ø± Ø®Ù„Ø§Ù„ 6 Ø³Ù†ÙˆØ§Øª');
            };
            if (window.f) {
                f.addEventListener('submit', () => setTimeout(postProcess));
            } else {
                document.addEventListener('submit', () => setTimeout(postProcess), true);
            }
        } catch (e) { /* ØªØ¬Ø§Ù‡Ù„ Ø£ÙŠ Ø®Ø·Ø£ Ø¨Ø³ÙŠØ· ÙÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© */ }
    })();
</script>

</html>
